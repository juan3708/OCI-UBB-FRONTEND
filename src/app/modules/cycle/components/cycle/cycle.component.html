<!-- <div class="container-lg-10" style="display: flex; align-items: center; justify-content: center;">
    <div class="col-lg-10 grid-margin stretch-card"> -->
<div class="card">
    <div class="card-body">
        <h4 class="card-title"><b>Ciclos</b></h4>
        <div class="table-responsive">
            <div class="card" *ngIf="cycleSee.niveles.length == 0">
                <h5>Proceso de creación del ciclo ({{cycleSee.nombre}})</h5>
                <section class="step-wizard">
                    <ul class="step-wizard-list">
                        <li [class.current-item]='cycleSee.establecimientos.length == 0' class="step-wizard-item">
                            <span class="progress-count">1</span>
                            <span class="progress-label">Asignar <br> Establecimientos (<i
                                    class="mdi mdi-book-plus"></i>)</span>
                        </li>
                        <li [class.current-item]='cycleSee.establecimientoTieneCupos == false && cycleSee.establecimientos.length >= 1'
                            class="step-wizard-item ">
                            <span class="progress-count">2</span>
                            <span class="progress-label">Asignar cupos (<i class="mdi mdi-school"></i>)</span>
                        </li>
                        <li [class.current-item]='cycleSee.establecimientoTieneCupos == true && cycleSee.establecimientos.length >= 1 && cycleSee.alumnos.length == 0'
                            class="step-wizard-item ">
                            <span class="progress-count">3</span>
                            <span class="progress-label">Cargar alumnos (Alumnos Postulantes)</span>
                        </li>
                        <li [class.current-item]='cycleSee.establecimientoTieneCupos == true && cycleSee.establecimientos.length >= 1 && cycleSee.alumnos.length >= 1 && cycleSee.alumnosParticipantes == 0'
                            class="step-wizard-item ">
                            <span class="progress-count">4</span>
                            <span class="progress-label">Inscribir alumnos (Alumnos Postulantes)</span>
                        </li>
                        <li [class.current-item]='cycleSee.establecimientoTieneCupos == true && cycleSee.establecimientos.length >= 1 && cycleSee.alumnos.length >= 1 && cycleSee.alumnosParticipantes >= 1 && cycleSee.niveles.length == 0'
                            class="step-wizard-item ">
                            <span class="progress-count">5</span>
                            <span class="progress-label">Crear Niveles (Nivel)</span>
                        </li>
                    </ul>
                </section>
            </div>
        </div>

        <button type="button" style="float: right; margin: 8px;" class="btn btn-gradient-info btn-rounded btn-sm"
            (click)="openModal(ModalContent)">Crear
            ciclo</button>
        <button type="button" style="float: right; margin: 8px;"
            class="btn btn-gradient-info btn-rounded btn-sm sendMails" (click)="openModal(EmailModal)"
            title="Enviar mensaje"><i class="mdi mdi-email"></i></button>
        <div class="table-responsive">
            <table datatable [dtOptions]="dtOptions" [dtTrigger]="dtTrigger" class="table table-striped"
                style="text-align: center;">
                <thead class="table table-bordered">
                    <tr>
                        <th>
                            <b>Año</b>
                        </th>
                        <th>
                            <b>Nombre</b>
                        </th>
                        <th>
                            <b>Fecha Inicio</b>
                        </th>
                        <th>
                            <b>Fecha Termino</b>
                        </th>
                        <th>
                            <b>Presupuesto</b>
                        </th>
                        <th>
                            <b>Coordinador</b>
                        </th>
                        <th>
                            <b>Acciones</b>
                        </th>
                    </tr>
                </thead>
                <tbody class="table table-bordered">
                    <tr *ngFor="let cycle of cycles">
                        <td>
                            {{cycle.anio}}
                        </td>
                        <td>
                            {{cycle.nombre}}
                        </td>
                        <td>
                            {{cycle.fecha_inicio | date:"dd-MM-yyyy"}}
                        </td>
                        <td>
                            {{cycle.fecha_termino | date:"dd-MM-yyyy"}}
                        </td>
                        <td>
                            ${{cycle.presupuesto |currency: 'CLP':""}}
                        </td>
                        <td>
                            {{cycle.coordinador.nombre}} {{cycle.coordinador.apellido}}
                        </td>
                        <td>
                            <button type="button" class="btn btn-gradient-success btn-rounded btn-sm btn-see"
                                (click)="getStatisticPerCycle(cycle.id,ModalContentStatistics);setCycle(cycle)"
                                title="Estadistica del ciclo"><i class="mdi mdi-eye"></i></button>
                            <button type="button" class="btn btn-gradient-info btn-rounded btn-sm "
                                (click)="openModal(ModalContentEdit);setCycle(cycle)"
                                *ngIf="cycle.fecha_termino >= currentDate" title="Editar ciclo"><i
                                    class="mdi mdi-grease-pencil"></i></button>
                            <button type="button" class="btn btn-gradient-info btn-rounded btn-sm btn-edit"
                                (click)="getCycle(cycle.id,SelectEstableshments)"
                                *ngIf="cycle.fecha_termino >= currentDate" title="Asignar Establecimientos"><i
                                    class="mdi mdi-book-plus"></i></button>
                            <button type="button" class="btn btn-gradient-info btn-rounded btn-sm btn-edit"
                                (click)="getCycle(cycle.id,EditQuotasPerEstableshment)"
                                *ngIf="cycle.establecimientos.length >=1" title="Cupos por establecimiento"><i
                                    class="mdi mdi-school"></i></button>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>
<!-- </div>
</div> -->

<!-- Modal Create starts -->
<ng-template class="modal fade" #ModalContent let-modal>
    <div class="modal-content">
        <div class="modal-header">
            <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close" (click)="modal.dismiss()">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>
        <div class="modal-body">
            <div class="col-12 stretch-card">
                <div class="card">
                    <div class="card-body">
                        <h4 class="card-title">Crear ciclo</h4>
                        <p class="card-description">
                            Ingrese los campos para la creacion del ciclo.
                        </p>
                        <form class="forms-sample">
                            <div class="form-group">
                                <label for="year">Anio</label>
                                <input type="text" class="form-control" id="year" placeholder="1999" #year>
                            </div>
                            <div class="form-group">
                                <label for="name">Nombre</label>
                                <input type="text" class="form-control" id="name" placeholder="Nombre" #name>
                            </div>
                            <div class="form-group">
                                <label for="budget">Presupuesto</label>
                                <input type="text" class="form-control" id="budget" placeholder="100000000" #budget>
                            </div>
                            <div class="form-group">
                                <label for="startDate">Fecha de inicio</label>
                                <input style="width: 50%;" type="date" class="form-control" id="startDate"
                                    placeholder="aaaa-mm-dd" #startDate>
                            </div>
                            <div class="form-group">
                                <label for="finishDate">Fecha de termino</label>
                                <input style="width: 50%;" type="date" class="form-control" id="finishDate"
                                    placeholder="aaaa-mm-dd" #finishDate>
                            </div>
                            <div class="form-group">
                                <label for="coordinator">Coordinador</label>
                                <div class="input-group mb-3">
                                    <div class="input-group-prepend">
                                    </div>
                                    <select class="custom-select" id="inputGroupSelect01" #coordinator>
                                        <option selected>Seleccione un coordinador</option>
                                        <option *ngFor="let coordinator of coordinators" [value]="coordinator.id">
                                            {{coordinator.nombre}} {{coordinator.apellidos}}</option>
                                    </select>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-success"
                (click)="cycleFormCreate(year.value, name.value, startDate.value, finishDate.value, budget.value, coordinator.value, modal)">Crear</button>
            <button type="button" class="btn btn-light" data-dismiss="modal" (click)="modal.close()">Cancelar</button>
        </div>
    </div>
</ng-template>
<!-- Modal Create Ends -->

<!-- Modal Edit starts -->
<ng-template class="modal fade" #ModalContentEdit let-modal>
    <div class="modal-content">
        <div class="modal-header">
            <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close" (click)="modal.dismiss()">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>
        <div class="modal-body">
            <div class="col-12 stretch-card">
                <div class="card">
                    <div class="card-body">
                        <h4 class="card-title">Editar ciclo</h4>
                        <p class="card-description">
                            Ingrese los campos para la modificacion del ciclo.
                        </p>
                        <form class="forms-sample" #f="ngForm">
                            <div class="form-group">
                                <label for="year">Año</label>
                                <input type="text" class="form-control" id="year" [(ngModel)]="cycle.anio" name="year"
                                    #year="ngModel">
                            </div>
                            <div class="form-group">
                                <label for="name">Nombre</label>
                                <input type="text" class="form-control" id="name" [(ngModel)]="cycle.nombre" name="name"
                                    #name="ngModel">
                            </div>
                            <div class="form-group">
                                <label for="budget">Presupuesto</label>
                                <input type="text" class="form-control" id="budget" [(ngModel)]="cycle.presupuesto"
                                    name="budget" #budget="ngModel">
                            </div>
                            <div class="form-group">
                                <label for="startDate">Fecha de inicio</label>
                                <input style="width: 50%;" type="date" class="form-control" id="startDate"
                                    [(ngModel)]="cycle.fecha_inicio" name="startDate" #startDate="ngModel">
                            </div>
                            <div class="form-group">
                                <label for="finishDate">Fecha de termino</label>
                                <input style="width: 50%;" type="date" class="form-control" id="finishDate"
                                    [(ngModel)]="cycle.fecha_termino" name="finishDate" #finishDate="ngModel">
                            </div>
                            <div class="form-group">
                                <label for="coordinator">Coordinador</label>
                                <div class="input-group mb-3">
                                    <div class="input-group-prepend">
                                    </div>
                                    <select class="custom-select" id="coordinator" [(ngModel)]="cycle.coordinador_id"
                                        name="coordinator" #coordinator="ngModel">
                                        <option selected>Seleccione un establecimiento</option>
                                        <option *ngFor="let coordinator of coordinators" [value]="coordinator.id">
                                            {{coordinator.nombre}} {{coordinator.apellidos}}</option>
                                    </select>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-success" (click)="cycleFormEdit(f, modal)">Editar</button>
            <button type="button" class="btn btn-light" data-dismiss="modal" (click)="modal.close()">Cancelar</button>
        </div>
    </div>
</ng-template>
<!-- Modal Edit ends -->

<!-- Modal SelectEstableshments starts -->
<ng-template class="modal fade" #SelectEstableshments let-modal>
    <div class="modal-content">
        <div class="modal-header">
            <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close"
                (click)="modal.dismiss();clearForm()">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>
        <div class="modal-body">
            <div class="col-12 stretch-card">
                <div class="card">
                    <div class="card-body">
                        <h4 class="card-title">Seleccionar establecimientos que participaran de las
                            {{cycleModel.nombre}}
                        </h4>
                        <p class="card-description">
                            Seleccione los establecimientos que participaran de las OCI.
                        </p>
                        <form class="forms-sample" #f="ngForm">
                            <div *ngIf="establishmentsPerCycle.length >=1">
                                <h5>Establecimientos seleccionados</h5>
                                <div class="table-responsive">
                                    <table class="table table-striped" style="text-align: center;">
                                        <thead class="table table-bordered">
                                            <tr>
                                                <th>
                                                    <b>Nombre del establecimiento</b>
                                                </th>

                                                <th>
                                                    <b>Eliminar</b>
                                                </th>
                                            </tr>
                                        </thead>
                                        <tbody class="table table-bordered">
                                            <tr *ngFor="let establishment of establishmentsPerCycle">
                                                <td>
                                                    {{establishment.nombre}}
                                                </td>
                                                <td>
                                                    <a type="button" data-dismiss="modal"
                                                        (click)="removeEstablishment(establishment.id)"><i
                                                            class="mdi mdi-account-minus"
                                                            style="font-size: 20px;"></i></a>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            <br>
                            <div *ngIf="establishments.length >=1">
                                <h5>Establecimientos</h5>
                                <div class="table-responsive">
                                    <table class="table table-striped" style="text-align: center;">
                                        <thead class="table table-bordered">
                                            <tr>
                                                <th>
                                                    <b>Seleccionar</b>
                                                </th>
                                                <th>
                                                    <b>Nombre del establecimiento</b>
                                                </th>
                                            </tr>
                                        </thead>
                                        <tbody class="table table-bordered">
                                            <tr *ngFor="let establishment of establishments">
                                                <td>
                                                    <input type="checkbox" class="form-check-input position-static"
                                                        style="text-align: center;width: 20px;" id="establishment"
                                                        (change)="addOrRemoveEstablishments($event.target.checked, establishment.id)"
                                                        #studentLevel>
                                                    <i class="input-helper"></i>
                                                </td>
                                                <td>
                                                    {{establishment.nombre}}
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-success" (click)="addEstablishmentsPerCycle(modal)">Asginar</button>
            <button type="button" class="btn btn-light" data-dismiss="modal"
                (click)="modal.close();clearForm()">Cancelar</button>
        </div>
    </div>
</ng-template>
<!-- Modal SelectEstableshments ends -->

<!-- Modal EditQuotasPerEstableshment starts -->
<ng-template class="modal fade" #EditQuotasPerEstableshment let-modal>
    <div class="modal-content">
        <div class="modal-header">
            <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close"
                (click)="modal.dismiss();clearForm()">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>
        <div class="modal-body">
            <div class="col-12 stretch-card">
                <div class="card">
                    <div class="card-body" [formGroup]="editFeeEstablishment">
                        <h4 class="card">Cupos de los establecimiento</h4>
                        <p class="card-description">
                            Ingrese los campos para la modificacion de cupos por establecimiento.
                        </p>
                        <div class="table-responsive">
                            <table class="table table-striped" style="text-align: center;">
                                <thead class="table table-bordered">
                                    <tr>
                                        <th>
                                            <b>Nombre del establecimiento</b>
                                        </th>
                                        <th>
                                            <b>Cupos</b>
                                        </th>
                                    </tr>
                                </thead>
                                <tbody class="table table-bordered" formArrayName="establishmentsFee">
                                    <ng-container
                                        *ngFor="let establishment of establishmentsFee.controls; let i = index">
                                        <tr [formGroupName]="i">
                                            <td>
                                                {{establishment.controls.nombre.value}}
                                            </td>
                                            <div class="form-group" style="display: none">
                                                <input type="text" class="form-control" id="id" formControlName="id">
                                            </div>
                                            <td>
                                                <div class="form-group">
                                                    <input type="text" class="form-control" id="fee"
                                                        formControlName="cupos">
                                                </div>
                                            </td>
                                        </tr>
                                    </ng-container>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-success"
                (click)="establishmentQuotesEdit(editFeeEstablishment.value, modal)"
                *ngIf="cycle.fecha_termino >= currentDate">Asignar</button>
            <button type="button" class="btn btn-light" data-dismiss="modal"
                (click)="modal.close();clearForm();">Cancelar</button>
        </div>
    </div>
</ng-template>
<!-- Modal EditQuotasPerEstableshment ends -->

<!-- Modal Statistics starts -->
<ng-template class="modal fade" #ModalContentStatistics let-modal>
    <div class="modal-content">
        <div class="modal-header">
            <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close" (click)="modal.dismiss()">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>
        <div class="col-12 grid-margin">
            <div class="card">
                <ul class="nav nav-tabs nav-fill" id="myTab" role="tablist">
                    <li class="nav-item">
                        <a class="nav-link active " id="student-tab" data-toggle="tab" href="#student" role="tab"
                            aria-controls="student" aria-selected="true"><i class="fa-solid fa-id-card-clip"></i>
                            Información</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" id="assistancePerCycle-tab" data-toggle="tab" href="#assistancePerCycle"
                            role="tab" aria-controls="assistancePerCycle" aria-selected="false"><i
                                class="fa-solid fa-rectangle-list"></i> Asistencia</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" id="score-tab" data-toggle="tab" href="#score" role="tab"
                            aria-controls="score" aria-selected="false"><i class="fa-solid fa-square-poll-vertical"></i>
                            Competencias</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" id="costs-tab" data-toggle="tab" href="#costs" role="tab"
                            aria-controls="costs" aria-selected="false"><i class="mdi mdi-currency-usd"></i>
                            Gastos</a>
                    </li>
                </ul>
                <!-- TAB INFORMACION ALUMNO -->
                <div>
                    <button type="button" style="float: right;width: 150px;margin: 8px"
                        class="btn btn-gradient-info btn-rounded btn-sm export-pdf" (click)="exportPdf()">Exportar a PDF
                        <i class="fa-solid fa-file-pdf"></i></button>
                    <div class="d-flex justify-content-center" *ngIf="spinnerSee == true"
                        style="float: right;padding-top: 10px;">
                        <div class="spinner-border text-success" role="status">
                        </div>
                        <span style="padding-top: 7px;padding-left: 6px;">Generando documento, espere porfavor.</span>
                    </div>
                </div>
                <div class="tab-content" id="myTabContent">
                    <div class="tab-pane fade show active" id="student" role="tabpanel" aria-labelledby="student-tab">
                        <div class="col-12 grid-margin">
                            <div class="card">
                                <h5 style="font-weight: bold;text-align: center;">Estadistica del ciclo</h5>
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="form-group row">
                                                <label class="col-sm-3 col-form-label label-ident">Nombres:</label>
                                                <div class="col-sm-9">
                                                    <label
                                                        class="col-sm-4 col-form-label label-result">{{cycle.nombre}}</label>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="form-group row">
                                                <label class="col-sm-3 col-form-label label-ident">Año:</label>
                                                <div class="col-sm-9">
                                                    <label
                                                        class="col-sm-4 col-form-label label-result">{{cycle.anio}}</label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="form-group row">
                                                <label class="col-sm-3 col-form-label label-ident">Fecha de
                                                    inicio</label>
                                                <div class="col-sm-9">
                                                    <label
                                                        class="col-sm-5 col-form-label label-result">{{cycle.fecha_inicio
                                                        |
                                                        date:"dd-MM-yyyy" }}</label>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="form-group row">
                                                <label class="col-sm-3 col-form-label label-ident">Fecha de
                                                    termino:</label>
                                                <div class="col-sm-9">
                                                    <label
                                                        class="col-sm-5 col-form-label label-result">{{cycle.fecha_termino
                                                        |
                                                        date:"dd-MM-yyyy" }}</label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="form-group row">
                                                <label class="col-sm-3 col-form-label label-ident">Coordinador:</label>
                                                <div class="col-sm-9">
                                                    <label
                                                        class="col-sm-4 col-form-label label-result">{{cycle.coordinador.nombre}}
                                                        {{cycle.coordinador.apellidos}}</label>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="form-group row">
                                                <label class="col-sm-3 col-form-label label-ident">Competencias
                                                    totales:</label>
                                                <div class="col-sm-9">
                                                    <label class="col-sm-9 col-form-label label-result"
                                                        *ngIf="competencias.length >=1" label-result>
                                                        {{competencias.length}}</label>

                                                    <label class="col-sm-9 col-form-label"
                                                        *ngIf="competencias.length == 0" style="font-weight: bold;">NO
                                                        EXISTEN COMPETENCIAS ASOCIADAS</label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="form-group row">
                                                <label class="col-sm-3 col-form-label label-ident">Establecimientos
                                                    participantes:</label>
                                                <div class="col-sm-9">
                                                    <label
                                                        class="col-sm-9 col-form-label label-result">{{cantEstablecimientos}}</label>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="form-group row">
                                                <label class="col-sm-3 col-form-label label-ident">Diferencia en
                                                    comparación con la Oci anterior ({{cicloAnterior.nombre}}): </label>
                                                <div class="col-sm-9">
                                                    <label class="col-sm-9 col-form-label label-result positive"
                                                        *ngIf="diferenciaEstablecimientos > 0">{{diferenciaEstablecimientos}}</label>
                                                    <label class="col-sm-9 col-form-label label-result negative"
                                                        *ngIf="diferenciaEstablecimientos < 0 && cicloAnterior != -1">{{diferenciaEstablecimientos}}</label>
                                                    <label class="col-sm-9 col-form-label label-result"
                                                        *ngIf="diferenciaEstablecimientos == 0 && cicloAnterior != -1">{{diferenciaEstablecimientos}}</label>
                                                    <label class="col-sm-9 col-form-label label-result"
                                                        *ngIf="cicloAnterior == -1" style="font-weight: bold;">NO EXISTE
                                                        OCI ANTERIOR</label>

                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="form-group row">
                                                <label class="col-sm-3 col-form-label label-ident">Cantidad de alumnos
                                                    inscritos:</label>
                                                <div class="col-sm-9">
                                                    <label
                                                        class="col-sm-9 col-form-label label-result">{{cantidadAlumnosInscritos}}</label>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="form-group row">
                                                <label class="col-sm-3 col-form-label label-ident">Diferencia en
                                                    comparacion a la Oci anterior ({{cicloAnterior.nombre}}): </label>
                                                <div class="col-sm-9">
                                                    <label class="col-sm-9 col-form-label label-result positive"
                                                        *ngIf="diferenciaAlumnosInscritos > 0">{{diferenciaAlumnosInscritos}}</label>
                                                    <label class="col-sm-9 col-form-label label-result negative"
                                                        *ngIf="diferenciaAlumnosInscritos < 0 && cicloAnterior != -1">{{diferenciaAlumnosInscritos}}</label>
                                                    <label class="col-sm-9 col-form-label label-result"
                                                        *ngIf="diferenciaAlumnosInscritos == 0">{{diferenciaAlumnosInscritos}}</label>
                                                    <label class="col-sm-9 col-form-label label-result"
                                                        *ngIf="cicloAnterior == -1" style="font-weight: bold;">NO EXISTE
                                                        OCI ANTERIOR</label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="form-group row">
                                                <label class="col-sm-3 col-form-label label-ident">Cantidad de alumnos
                                                    participantes:</label>
                                                <div class="col-sm-9">
                                                    <label
                                                        class="col-sm-9 col-form-label label-result">{{cantidadAlumnosParticipantes}}</label>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="form-group row">
                                                <label class="col-sm-3 col-form-label label-ident">Diferencia en
                                                    comparacion a la Oci anterior ({{cicloAnterior.nombre}}): </label>
                                                <div class="col-sm-9">
                                                    <label class="col-sm-9 col-form-label label-result positive"
                                                        *ngIf="diferenciaAlumnosParticipantes > 0">{{diferenciaAlumnosParticipantes}}</label>
                                                    <label class="col-sm-9 col-form-label label-result negative"
                                                        *ngIf="diferenciaAlumnosParticipantes < 0 && cicloAnterior != -1">{{diferenciaAlumnosParticipantes}}</label>
                                                    <label class="col-sm-9 col-form-label label-result"
                                                        *ngIf="diferenciaAlumnosParticipantes == 0">{{diferenciaAlumnosParticipantes}}</label>
                                                    <label class="col-sm-9 col-form-label label-result"
                                                        *ngIf="cicloAnterior == -1" style="font-weight: bold;">NO EXISTE
                                                        OCI ANTERIOR</label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>


                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="form-group row">
                                                <label class="col-sm-3 col-form-label label-ident">Establecimiento con
                                                    mas alumnos
                                                    inscritos:</label>
                                                <div class="col-sm-9">
                                                    <label
                                                        class="col-sm-9 col-form-label label-result">{{establecimientoMaxInscritos.nombre}}
                                                        con la
                                                        cantidad de
                                                        {{establecimientoMaxInscritos.Alumnos}} alumnos</label>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="form-group row">
                                                <label class="col-sm-3 col-form-label label-ident">Establecimiento con
                                                    menos alumnos
                                                    inscritos: </label>
                                                <div class="col-sm-9">
                                                    <label
                                                        class="col-sm-9 col-form-label label-result">{{establecimientoMinInscritos.nombre}}
                                                        con la
                                                        cantidad de
                                                        {{establecimientoMinInscritos.Alumnos}} alumnos</label>

                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="form-group row">
                                                <label class="col-sm-3 col-form-label label-ident">Establecimiento con
                                                    mas alumnos
                                                    participantes:</label>
                                                <div class="col-sm-9">
                                                    <label
                                                        class="col-sm-9 col-form-label label-result">{{establecimientoMaxParticipantes.nombre}}
                                                        con
                                                        la
                                                        cantidad de {{establecimientoMaxParticipantes.Alumnos}}
                                                        alumnos</label>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="form-group row">
                                                <label class="col-sm-3 col-form-label label-ident">Establecimiento con
                                                    menos alumnos
                                                    participantes: </label>
                                                <div class="col-sm-9">
                                                    <label
                                                        class="col-sm-9 col-form-label label-result">{{establecimientoMinParticipantes.nombre}}
                                                        con la
                                                        cantidad de {{establecimientoMinParticipantes.Alumnos}}
                                                        alumnos</label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- TAB ASISTENCIA -->
                    <div class="tab-pane fade" id="assistancePerCycle" role="tabpanel"
                        aria-labelledby="assistancePerCycle-tab">
                        <div *ngIf="establecimientos.length >=1">
                            <div class="card">
                                <h5>Asistencia por establecimientos del ciclo</h5>
                            </div>
                            <ngb-accordion [closeOthers]="false" activeIds="collapse-12" class="accordion-solid-header">
                                <ngb-panel id="collapse-{{indexEstablishments}}"
                                    *ngFor="let establishment of  establecimientos;let indexEstablishments = index"
                                    title="{{establishment.nombre}} -  TOTAL ALUMNOS: {{establishment.alumnos.length}}"
                                    style="font-weight: bold;">
                                    <ng-template ngbPanelContent>
                                        <div *ngIf="establishment.alumnos.length >=1">
                                            <div class="table-responsive">
                                                <h5>Alumnos</h5>
                                                <table class="table table-striped" style="text-align: center;">
                                                    <thead class="table table-bordered">
                                                        <tr>
                                                            <th>
                                                                <b>Rut</b>
                                                            </th>
                                                            <th>
                                                                <b>Nombre</b>
                                                            </th>
                                                            <th>
                                                                <b>Apellidos</b>
                                                            </th>
                                                            <th>
                                                                <b>Porcentaje de asistencia</b>
                                                            </th>
                                                            <th>
                                                                <b>Asistencias</b>
                                                            </th>
                                                            <th>
                                                                <b>Inasistencias</b>
                                                            </th>
                                                            <th>
                                                                <b>Total Clases</b>
                                                            </th>
                                                            <th>
                                                                <b>Ver clases</b>
                                                            </th>
                                                        </tr>
                                                    </thead>
                                                    <tbody class="table table-bordered">
                                                        <tr *ngFor="let student of establishment.alumnos">
                                                            <td>
                                                                {{student.rut}}
                                                            </td>
                                                            <td>
                                                                {{student.nombre}}
                                                            </td>
                                                            <td>
                                                                {{student.apellidos}}
                                                            </td>
                                                            <td *ngIf="student.PorcentajeAsistencia <=30"
                                                                style="color: red;">
                                                                {{student.PorcentajeAsistencia}}%
                                                            </td>
                                                            <td *ngIf="student.PorcentajeAsistencia >30 && student.PorcentajeAsistencia<=50"
                                                                style="color: yellow;">
                                                                {{student.PorcentajeAsistencia}}%
                                                            </td>
                                                            <td *ngIf="student.PorcentajeAsistencia >50 && student.PorcentajeAsistencia <=70"
                                                                style="color: yellowgreen;">
                                                                {{student.PorcentajeAsistencia}}%
                                                            </td>
                                                            <td *ngIf="student.PorcentajeAsistencia >70"
                                                                style="color: green;">
                                                                {{student.PorcentajeAsistencia}}%
                                                            </td>
                                                            <td>
                                                                {{student.CantAsistenciasEInasistencias[0].asistencias}}
                                                            </td>
                                                            <td>
                                                                {{student.CantAsistenciasEInasistencias[0].inasistencias}}
                                                            </td>
                                                            <td>
                                                                {{student.Asistencias.length}}
                                                            </td>
                                                            <td>
                                                                <button type="button"
                                                                    class="btn btn-gradient-success btn-rounded btn-sm btn-see"
                                                                    (click)="openModal(ModalContentLessonPerStudent);setStudent(student)"><i
                                                                        class="fa-solid fa-person-chalkboard"></i></button>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                        <div *ngIf="establishment.alumnos.length == 0">
                                            <h5 style="font-weight:bold;">NO EXISTEN CLASES ASOCIADAS.</h5>
                                        </div>
                                        <br>
                                    </ng-template>
                                </ngb-panel>
                            </ngb-accordion>
                        </div>
                        <div *ngIf="establecimientos.length ==0">
                            <h5 style="font-weight:bold;">NO EXISTEN ESTABLECIMIENTOS CON CLASES ASOCIADAS.</h5>
                        </div>
                    </div>
                    <!-- TAB COMPETENCIAS -->
                    <div class="tab-pane fade" id="score" role="tabpanel" aria-labelledby="score-tab">
                        <div *ngIf="gastos.length >=1">
                            <div class="card">
                                <h5>Competencias de la OCI</h5>
                            </div>
                            <div class="card">
                                <div *ngFor="let competition of competencias">
                                    <div class="table-responsive">
                                        <thead class="table table-bordered">
                                            <tr>
                                                <th style="border: transparent;">Fecha: {{competition.fecha |
                                                    date:"dd-MM-yyyy"}}</th>

                                                <th class="thGastos">
                                                    Tipo de competición: {{competition.tipo}}
                                                </th>
                                                <th class="thGastos">
                                                    Lugar: {{competition.lugar}}
                                                </th>
                                                <th class="thGastos">
                                                    Puntaje promedio: {{competition.promedioPuntaje}}
                                                </th>
                                                <th class="thGastos">
                                                    Cantidad total de alumnos: {{competition.alumnos.length}}
                                                </th>
                                            </tr>
                                        </thead>
                                        <table class="table table-striped" style="text-align: center;"
                                            style="background-color: transparent;">
                                            <thead class="table table-bordered">
                                                <tr>
                                                    <th>
                                                        <b>Rut</b>
                                                    </th>
                                                    <th>
                                                        <b>Nombre</b>
                                                    </th>
                                                    <th>
                                                        <b>Apellidos</b>
                                                    </th>
                                                    <th>
                                                        <b>Establecimiento</b>
                                                    </th>
                                                    <th>
                                                        <b>Puntaje</b>
                                                    </th>
                                                </tr>
                                            </thead>
                                            <tbody class="table table-bordered">
                                                <tr *ngFor="let student of competition.alumnos">
                                                    <td>
                                                        {{student.rut}}
                                                    </td>
                                                    <td>
                                                        {{student.nombre}}
                                                    </td>
                                                    <td>
                                                        {{student.apellidos}}
                                                    </td>
                                                    <td>
                                                        {{student.establecimiento.nombre}}
                                                    </td>
                                                    <td>
                                                        {{student.pivot.puntaje}}
                                                    </td>
                                                </tr>
                                            </tbody>
                                            <br>
                                        </table>
                                    </div>
                                </div>
                            </div>

                        </div>
                        <div *ngIf="competencias.length == 0">
                            <h5>NO EXISTEN COMPETENCIAS ASOCIADAS.</h5>
                        </div>
                    </div>
                    <!-- TAB GASTOS -->
                    <div class="tab-pane fade" id="costs" role="tabpanel" aria-labelledby="costs-tab">
                        <div *ngIf="gastos.length >=1">
                            <div class="card">
                                <div class="table-responsive">
                                    <table class="table table-striped" style="text-align: center;"
                                        style="background-color: transparent;border: transparent;">
                                        <thead class="table table-bordered"
                                            style="background-color: transparent;border: transparent;">
                                            <tr>
                                                <th class="thGastos">
                                                    <h5> Prespuesto Actual: ${{cycle.presupuesto | currency: 'CLP':""}}
                                                    </h5>
                                                </th>
                                                <th class="thGastos">
                                                    <h5>Total Gastado: ${{totalGastos | currency: 'CLP':""}}</h5>
                                                </th>
                                                <th class="thGastos">
                                                    <h5>Presupuesto restante: ${{prespuestoRestante | currency:
                                                        'CLP':""}}</h5>
                                                </th>
                                            </tr>
                                        </thead>
                                        <br>
                                    </table>
                                </div>
                            </div>
                            <div class="card">
                                <div *ngFor="let cost of gastos">
                                    <div class="table-responsive">
                                        <thead class="table table-bordered">
                                            <tr>
                                                <th style="border: transparent;">Fecha: {{cost.fecha|
                                                    date:"dd-MM-yyyy"}}</th>
                                                <th *ngIf="cost.actividad == null&&cost.competencia == null"
                                                    class="thGastos">
                                                    No asociado.
                                                </th>
                                                <th *ngIf="cost.actividad &&cost.competencia" class="thGastos">
                                                    Asociado con la Actividad: {{cost.actividad.nombre}} y Competencia:
                                                    {{cost.competencia.tipo}}
                                                </th>
                                                <th *ngIf="cost.actividad && cost.competencia == null" class="thGastos">
                                                    Asociado con la Actividad: {{cost.actividad.nombre}}
                                                </th>
                                                <th *ngIf="cost.competencia && cost.actividad == null" class="thGastos">
                                                    Asociado con la Competencia: {{cost.competencia.tipo}}
                                                </th>
                                            </tr>
                                        </thead>
                                        <table class="table table-striped" style="text-align: center;"
                                            style="background-color: transparent;">

                                            <thead class="table table-bordered">
                                                <tr>

                                                    <th>
                                                        <b>Nombre Detalle</b>
                                                    </th>
                                                    <th>
                                                        <b>Valor</b>
                                                    </th>
                                                </tr>
                                            </thead>
                                            <tbody class="table table-bordered">
                                                <tr *ngFor="let detail of cost.detalles">
                                                    <td>
                                                        {{detail.nombre}}
                                                    </td>
                                                    <td>
                                                        ${{detail.valor | currency: 'CLP':""}}
                                                    </td>
                                                </tr>
                                            </tbody>
                                            <td style="font-weight: bold;text-align: right;">TOTAL:</td>
                                            <td style="border: 1px solid #ebedf2;">${{cost.valor | currency: 'CLP':"" }}
                                            </td>
                                            <br>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div *ngIf="gastos.length == 0">
                            <h5>NO EXISTEN GASTOS ASOCIADOS.</h5>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</ng-template>
<!-- Modal Statistics ends -->

<!-- Modal LessonPerStudent starts -->
<ng-template class="modal fade" #ModalContentLessonPerStudent let-modal>
    <div class="modal-content">
        <div class="card">
            <div class="card-header" style="font-weight:bold;">
                CLASES ASOCIADAS
                <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close" style="float: right;"
                    (click)="modal.dismiss()">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="card-body text-primary">
                <div class="table-responsive">
                    <table class="table table-striped" style="text-align: center;">
                        <thead class="table table-bordered">
                            <tr>
                                <th>
                                    <b>Fecha</b>
                                </th>
                                <th>
                                    <b>Contenido</b>
                                </th>
                                <th>
                                    <b>Asistencia</b>
                                </th>
                            </tr>
                        </thead>
                        <tbody class="table table-bordered">
                            <tr *ngFor="let clase of student.Asistencias">
                                <td>
                                    {{clase.fecha| date:"dd-MM-yyyy"}}
                                </td>
                                <td>
                                    {{clase.contenido}}
                                </td>
                                <td *ngIf="clase.pivot.asistencia == 1" style="color: green;font-weight: bold;">
                                    PRESENTE
                                </td>
                                <td *ngIf="clase.pivot.asistencia == 0" style="color: red;font-weight: bold;">
                                    AUSENTE
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</ng-template>
<!-- Modal LessonPerStudent Ends -->

<!-- Modal Mail starts -->
<ng-template class="modal fade" #EmailModal let-modal>
    <div class="modal-content">
        <div class="modal-header">
            <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close" (click)="modal.dismiss()">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>
        <div class="modal-body">
            <div class="col-12 stretch-card">
                <div class="card">
                    <div class="card-body">
                        <h4 class="card" style="text-align: center">Enviar mensaje</h4>
                        <p class="card-description">
                            Ingrese los campos para enviar un mensaje a los establecimientos.
                            Si desea enviar una invitacion masiva, llene el campo formulario con un formulario Google.
                        </p>
                        <form class="forms-sample">
                            <div class="form-group">
                                <input type="email" class="form-control to" id="to"
                                    placeholder="Destinatarios (No incluidos en la lista de emails de establecimientos)"
                                    #to>
                            </div>
                            <div class="form-group">
                                <input type="text" class="form-control subject" id="subject" placeholder="Asunto (*)"
                                    size="6" #subject>
                            </div>
                            <div class="form-group">
                                <textarea type="text" class="form-control content" id="content" #content rows="20"
                                    placeholder="(*)"></textarea>
                            </div>
                            <div class="form-group">
                                <input type="text-area" class="form-control to" id="link"
                                    placeholder="Link Formulario, solo si es una invitación" #link>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal-footer">
            <div class="d-flex justify-content-center" *ngIf="spinnerSee == true">
                <div class="spinner-border text-success" role="status">
                </div>
                <span>Enviando correo, espere porfavor</span>
            </div>
            <button type="button" class="btn btn-success"
                (click)="sendInvitations(to.value, subject.value, content.value, link.value, modal)">Enviar</button>
            <button type="button" class="btn btn-light" data-dismiss="modal" (click)="modal.close()">Cancelar</button>

        </div>
    </div>
</ng-template>
<!-- Modal Mail Ends -->